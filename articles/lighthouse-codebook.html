<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to lighthouse.codebook • lighthouse.codebook</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Introduction to lighthouse.codebook">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lighthouse.codebook</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/lighthouse-codebook.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ccsarapas/lighthouse.codebook/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to lighthouse.codebook</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ccsarapas/lighthouse.codebook/blob/main/vignettes/lighthouse-codebook.Rmd" class="external-link"><code>vignettes/lighthouse-codebook.Rmd</code></a></small>
      <div class="d-none name"><code>lighthouse-codebook.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="creating-codebooks">Creating codebooks<a class="anchor" aria-label="anchor" href="#creating-codebooks"></a>
</h2>
<p>Creating a codebook involves two general steps:</p>
<ol style="list-style-type: decimal">
<li><p>Create a “codebook” object in R from a data frame (and,
optionally, metadata), using <code><a href="../reference/cb_create.html">cb_create()</a></code> or a specialized
variant (such as <code><a href="../reference/cb_create_spss.html">cb_create_spss()</a></code> or
<code><a href="../reference/cb_create_redcap.html">cb_create_redcap()</a></code>).</p></li>
<li><p>Write the codebook to disk using
<code><a href="../reference/cb_write.html">cb_write()</a></code>.</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ccsarapas/lighthouse.codebook" class="external-link">lighthouse.codebook</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create and write a codebook without metadata</span></span>
<span><span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># with metadata</span></span>
<span><span class="va">dat</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span>metadata <span class="op">=</span> <span class="va">dat1_metadata</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># from SPSS data</span></span>
<span><span class="va">dat_spss</span> <span class="op">&lt;-</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://haven.tidyverse.org/reference/read_spss.html" class="external-link">read_sav</a></span><span class="op">(</span><span class="st">"dat_spss.sav"</span>, user_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_spss</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_create_spss.html">cb_create_spss</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb_spss.xlsx"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># from REDCap data</span></span>
<span><span class="va">dat_rc</span> <span class="op">&lt;-</span> <span class="fu">REDCapR</span><span class="fu">::</span><span class="fu">redcap_read</span><span class="op">(</span>redcap_uri <span class="op">=</span> <span class="va">rc_uri</span>, token <span class="op">=</span> <span class="va">rc_token</span><span class="op">)</span></span>
<span><span class="va">meta_rc</span> <span class="op">&lt;-</span> <span class="fu">REDCapR</span><span class="fu">::</span><span class="fu">redcap_metadata_read</span><span class="op">(</span>redcap_uri <span class="op">=</span> <span class="va">rc_uri</span>, token <span class="op">=</span> <span class="va">rc_token</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat_rc</span><span class="op">$</span><span class="va">data</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_create_redcap.html">cb_create_redcap</a></span><span class="op">(</span>metadata <span class="op">=</span> <span class="va">meta_rc</span><span class="op">$</span><span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb_rc.xlsx"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="codebook-contents">Codebook contents<a class="anchor" aria-label="anchor" href="#codebook-contents"></a>
</h2>
<p>The codebook written to disk will include an <em>overview</em> tab
listing all variables in the dataset; <em>summary</em> tabs for numeric,
categorical, and text variables; and, if grouping variables are
specified, <em>grouped summary</em> tabs for numeric and categorical
variables.</p>
<p>The <em>overview</em> tab includes one row for each variable in the
dataset, with information on variable types, labels, values, and
missingness. By default, each variable is hyperlinked to its location on
the relevant summary tab.</p>
<p><img src="img/overview.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>The <em>numeric summary</em> tab includes descriptive statistics for
all numeric variables in the dataset:</p>
<p><img src="img/numeric.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>The <em>categorical summary</em> tab includes frequencies for all
categorical variables, optionally with separate rows for user missing
values:</p>
<p><img src="img/categorical.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>Finally, the <em>text summary</em> tab includes frequencies for the
most common values for all text variables in the dataset. (The number of
values shown can be adjusted using the <code>n_text_vals</code> argument
to <code><a href="../reference/cb_write.html">cb_write()</a></code>.)</p>
<p><img src="img/text.png" class="r-plt" alt="" width="100%" style="display: block; margin: auto;"></p>
<p>If <code>group_by</code> is specified in <code><a href="../reference/cb_write.html">cb_write()</a></code>,
additional numeric and categorical summary tabs grouped by the specified
variables will be included.</p>
</div>
<div class="section level2">
<h2 id="customizing-codebooks">Customizing codebooks<a class="anchor" aria-label="anchor" href="#customizing-codebooks"></a>
</h2>
<p>There are many options for controlling how data is interpreted,
summarized, and presented. This section shows a few of the most useful
options. Further options are detailed in the documentation for
<code><a href="../reference/cb_create.html">cb_create()</a></code> and <code><a href="../reference/cb_write.html">cb_write()</a></code>.</p>
<div class="section level3">
<h3 id="grouped-summaries">Grouped summaries<a class="anchor" aria-label="anchor" href="#grouped-summaries"></a>
</h3>
<p>Numeric and categorical data summaries can be grouped by one or more
variables by specifying them in the <code>group_by</code> argument to
<code><a href="../reference/cb_write.html">cb_write()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb.xlsx"</span>, group_by <span class="op">=</span> <span class="va">treatment_group</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb.xlsx"</span>, group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment_group</span>, <span class="va">timepoint</span>, <span class="va">age_group</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>By default, values for each subgroup are shown in separate columns,
with decked heads if more than one grouping variable is specified.
However, some or all grouping variables can instead be shown in rows
using the <code>group_rows</code> argument.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show `treatment_group` in columns and `timepoint` in rows</span></span>
<span><span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span></span>
<span>    <span class="st">"cb.xlsx"</span>, </span>
<span>    group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment_group</span>, <span class="va">timepoint</span><span class="op">)</span>,</span>
<span>    group_rows <span class="op">=</span> <span class="va">timepoint</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Different row grouping behavior can be specified for numeric versus
categorical summary tabs using the <code>group_rows_numeric</code> and
<code>group_rows_categorical</code> arguments.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for numeric summary, show `treatment_group` in columns and `timepoint` in rows;</span></span>
<span><span class="co"># for categorical summary, show all grouping variables in columns</span></span>
<span><span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span></span>
<span>    <span class="st">"cb.xlsx"</span>, </span>
<span>    group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment_group</span>, <span class="va">timepoint</span><span class="op">)</span>,</span>
<span>    group_rows_numeric <span class="op">=</span> <span class="va">timepoint</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># for numeric summary, show all grouping variables in rows; </span></span>
<span><span class="co"># for categorical summary, show `treatment_group` in rows</span></span>
<span><span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span></span>
<span>    <span class="st">"cb.xlsx"</span>, </span>
<span>    group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment_group</span>, <span class="va">timepoint</span><span class="op">)</span>,</span>
<span>    group_rows_numeric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment_group</span>, <span class="va">timepoint</span><span class="op">)</span>,</span>
<span>    group_rows_categorical <span class="op">=</span> <span class="va">treatment_group</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="user-missing-values">User missing values<a class="anchor" aria-label="anchor" href="#user-missing-values"></a>
</h3>
<p>User missing values (also known as nonresponse codes, reserve codes,
or special values) can be specified using the <code>.user_missing</code>
argument to <code><a href="../reference/cb_create.html">cb_create()</a></code>. Missing values are specified using
a formula or list of formulas, with variables on the left-hand side (as
names or <a href="https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html" class="external-link">tidyselect</a>
expressions) and values on the right-hand side. If the left-hand side is
empty, user missings will be set for all compatible variables in the
dataset.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set a single missing value for a single variable</span></span>
<span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span>, .user_missing <span class="op">=</span> <span class="va">var1</span> <span class="op">~</span> <span class="fl">99</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for variables `var1` through `var5`</span></span>
<span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span>, .user_missing <span class="op">=</span> <span class="va">var1</span><span class="op">:</span><span class="va">var5</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">98</span>, <span class="fl">99</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for all numeric variables, plus `var6` and `var7`</span></span>
<span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>, </span>
<span>  <span class="va">metadata</span>, </span>
<span>  .user_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">var6</span>, <span class="va">var7</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">8</span>, <span class="op">-</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for all compatible variables in dataset</span></span>
<span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">metadata</span>, .user_missing <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">98</span>, <span class="fl">99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>If the user missing values are named, the names will be treated as
value labels in data summaries.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>, </span>
<span>  <span class="va">metadata</span>, </span>
<span>  .user_missing <span class="op">=</span> <span class="va">var1</span><span class="op">:</span><span class="va">var5</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Declined"</span> <span class="op">=</span> <span class="fl">98</span>, <span class="st">"Not applicable"</span> <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>To apply different user missings for different variables, pass a list
of formulas.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>, </span>
<span>  <span class="va">metadata</span>,</span>
<span>  .user_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu">starts_with</span><span class="op">(</span><span class="st">"status"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Declined"</span> <span class="op">=</span> <span class="fl">98</span>, <span class="st">"Not applicable"</span> <span class="op">=</span> <span class="fl">99</span><span class="op">)</span>,</span>
<span>    <span class="va">var7</span><span class="op">:</span><span class="va">var10</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Don't know"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, <span class="st">"Not applicable"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="missing-value-handling">Missing value handling<a class="anchor" aria-label="anchor" href="#missing-value-handling"></a>
</h3>
<p>On numeric summary tabs, missing values (including both user missing
values and <code>NA</code>) are dropped for computation of summary
statistics.</p>
<p>On ungrouped categorical and text summary tabs, by default, user
missing values are individually tabulated. For example, if
<code>.user_missing = ~ c("Declined" = 98,  "Not applicable" = 99)</code>,
then categorical and text summary tabs will include rows giving counts
for <code>"[98] Declined"</code> and <code>"[99] Not applicable"</code>.
All user missing values and <code>NA</code> can instead be collapsed
into a single <code>"(Missing)"</code> row using the
<code>detail_missing</code> argument to <code><a href="../reference/cb_write.html">cb_write()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span>.user_missing <span class="op">=</span> <span class="op">~</span>  <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Declined"</span> <span class="op">=</span> <span class="fl">98</span>, <span class="st">"Not applicable"</span> <span class="op">=</span> <span class="fl">99</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb.xlsx"</span>, detail_missing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Finally, user missing values are always collapsed (as though
<code>detail_missing = FALSE</code>) on <em>grouped</em> summary
tabs.</p>
</div>
<div class="section level3">
<h3 id="splitting-long-variable-labels">Splitting long variable labels<a class="anchor" aria-label="anchor" href="#splitting-long-variable-labels"></a>
</h3>
<p>Variable labels for sets of related variables sometimes share a
common prefix. Using the <code>.split_var_labels</code> argument to
<code><a href="../reference/cb_create.html">cb_create()</a></code>, this prefix can be extracted into a separate
column, making it easier to see at a glance what is unique about each
variable.</p>
<p>For example, given a set of variable labels that all begin with
<code>"What colors do  you like? Select all that apply: "</code>:</p>
<table class="table">
<thead><tr class="header">
<th>Name</th>
<th>Label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>age</td>
<td>How old are you today?</td>
</tr>
<tr class="even">
<td>colors1</td>
<td>What colors do you like? Select all that apply: Red</td>
</tr>
<tr class="odd">
<td>colors2</td>
<td>What colors do you like? Select all that apply: Green</td>
</tr>
<tr class="even">
<td>colors3</td>
<td>What colors do you like? Select all that apply: Blue</td>
</tr>
<tr class="odd">
<td>colors4</td>
<td>What colors do you like? Select all that apply: Orange</td>
</tr>
<tr class="even">
<td>height</td>
<td>What is your height in inches?</td>
</tr>
</tbody>
</table>
<p>You can split the labels for these variables, specifying them using a
<a href="https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html" class="external-link">tidyselect</a>
expression:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span></span>
<span>    <span class="va">data</span>, </span>
<span>    <span class="va">metadata</span>, </span>
<span>    .split_var_labels <span class="op">=</span> <span class="fu">starts_with</span><span class="op">(</span><span class="st">"colors"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb.xlsx"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th>Name</th>
<th>Label Stem</th>
<th>Label</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>age</td>
<td></td>
<td>How old are you today?</td>
</tr>
<tr class="even">
<td>colors1</td>
<td>What colors do you like? Select all that apply:</td>
<td>Red</td>
</tr>
<tr class="odd">
<td>colors2</td>
<td>What colors do you like? Select all that apply:</td>
<td>Green</td>
</tr>
<tr class="even">
<td>colors3</td>
<td>What colors do you like? Select all that apply:</td>
<td>Blue</td>
</tr>
<tr class="odd">
<td>colors4</td>
<td>What colors do you like? Select all that apply:</td>
<td>Orange</td>
</tr>
<tr class="even">
<td>height</td>
<td></td>
<td>What is your height in inches?</td>
</tr>
</tbody>
</table>
<p>Multiple sets of variables with common prefixes can be specified by
passing a list of tidyselect expressions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span></span>
<span>    <span class="va">data</span>, </span>
<span>    <span class="va">metadata</span>, </span>
<span>    .split_var_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">starts_with</span><span class="op">(</span><span class="st">"colors"</span><span class="op">)</span>, </span>
<span>      <span class="va">fav_food2</span><span class="op">:</span><span class="va">fav_food9</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rating1</span>, <span class="va">rating4</span><span class="op">:</span><span class="va">rating7</span>, <span class="va">rating9</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cb_write.html">cb_write</a></span><span class="op">(</span><span class="st">"cb.xlsx"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="variable-typing">Variable typing<a class="anchor" aria-label="anchor" href="#variable-typing"></a>
</h2>
<p>Data summaries are produced for “numeric,” “categorical,” and “text”
variables. For a given variable <code>x</code>, * <code>x</code> is
treated as categorical if (1) it is a factor, ordered factor, or logical
vector, <em>or</em> (2) it has associated value labels other than
missing value codes (specified in metadata or, for SPSS data, in a
<code>"haven_labelled"</code> vector). * <code>x</code> is treated as
numeric if (1) it is numeric (i.e., <code>is.numeric(x)</code> is
<code>TRUE</code>) <em>and</em> (2) it has no associated value labels
other than missing value codes. * <code>x</code> is treated as text if
(1) it is a character vector <em>and</em> (2) it has no associated value
labels other than missing value codes.</p>
<p>Thus, you can change how a variable is summarized by changing its
class. For instance, to get complete frequencies for a numeric or
character variable, convert it to a factor; to get only the top
frequencies for a factor with many levels, convert it to character.</p>
<p>Variables of other classes, such as dates, datetimes, and lists, are
not currently included on summary tabs. Summaries for dates and
datetimes are planned for a future release.</p>
</div>
<div class="section level2">
<h2 id="other-uses-for-the-codebook-object">Other uses for the codebook object<a class="anchor" aria-label="anchor" href="#other-uses-for-the-codebook-object"></a>
</h2>
<p>The <code>"lighthouse_codebook"</code> object created by
<code><a href="../reference/cb_create.html">cb_create()</a></code> will most commonly be used to write an Excel
codebook to disk using <code><a href="../reference/cb_write.html">cb_write()</a></code>. However, it can also be
used to create other objects in R.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example data</span></span>
<span><span class="va">q4_subset</span> <span class="op">&lt;-</span> <span class="va">gain_q4</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span>select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">XPID</span>, <span class="va">XOBS</span>, <span class="va">XRA</span>, <span class="va">B17</span>, <span class="va">SU4a</span>, <span class="va">SU4b</span>, <span class="va">SU1f99v</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create codebook</span></span>
<span><span class="va">cb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cb_create.html">cb_create</a></span><span class="op">(</span></span>
<span>  <span class="va">q4_subset</span>,</span>
<span>  metadata <span class="op">=</span> <span class="va">q4_metadata</span>,</span>
<span>  .user_missing <span class="op">=</span>  <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Not Asked"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>, </span>
<span>                      <span class="st">"Missing"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>, </span>
<span>                      <span class="st">"Confidential"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">6</span>, </span>
<span>                      <span class="st">"Refused"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">7</span>,</span>
<span>                      <span class="st">"Don't Know"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>, </span>
<span>                      <span class="st">"Legitimate Skip"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cb</span></span>
<span><span class="co"># # A tibble: 7 × 6</span></span>
<span><span class="co">#   name    type        label                         values user_missings missing</span></span>
<span><span class="co">#   &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;                         &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt;</span></span>
<span><span class="co"># 1 XPID    text        Participant ID                NA     [-9] Legitim…   0</span></span>
<span><span class="co"># 2 XOBS    categorical Observation Wave              [0] I… [-9] Legitim…   0</span></span>
<span><span class="co"># 3 XRA     categorical Random assignment             [0] C… [-9] Legitim…   0</span></span>
<span><span class="co"># 4 B17     categorical Pregnant                      [0] N… [-9] Legitim…   0.221</span></span>
<span><span class="co"># 5 SU4a    numeric     PPS - P90 days alcohol use    NA     [-9] Legitim…   0.394</span></span>
<span><span class="co"># 6 SU4b    numeric     PPS - P90 days drunk or 5+ d… NA     [-9] Legitim…   0.442</span></span>
<span><span class="co"># 7 SU1f99v text        QCS - P90 Days Other AOD Tx … NA     [-9] Legitim…   0.923</span></span></code></pre></div>
<div class="section level3">
<h3 id="extract-transformed-data">Extract transformed data<a class="anchor" aria-label="anchor" href="#extract-transformed-data"></a>
</h3>
<p>Use <code><a href="../reference/cb_get_data.html">cb_get_data()</a></code> to extract transformed data based in
several formats. <code>format  = "factors"</code> yields a dataset with
all variables with value labels converted to factors and user missings
converted to <code>NA</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cb_get_data.html">cb_get_data</a></span><span class="op">(</span><span class="va">cb</span>, format <span class="op">=</span> <span class="st">"factors"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 104 × 7</span></span>
<span><span class="co">#    XPID  XOBS    XRA       B17    SU4a  SU4b SU1f99v       </span></span>
<span><span class="co">#    &lt;chr&gt; &lt;fct&gt;   &lt;fct&gt;     &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#  1 001   Intake  Treatment No       NA    NA NA</span></span>
<span><span class="co">#  2 002   Intake  Control   No       10     4 NA</span></span>
<span><span class="co">#  3 003   Intake  Treatment No       10     1 Peer counselor</span></span>
<span><span class="co">#  4 003   3-month Treatment No       39    15 NA</span></span>
<span><span class="co">#  5 003   6-month Treatment No       NA    NA NA</span></span>
<span><span class="co">#  6 004   Intake  Control   No       10     2 NA</span></span>
<span><span class="co">#  7 004   3-month Control   No       55    63 NA</span></span>
<span><span class="co">#  8 004   6-month Control   No       10     1 NA</span></span>
<span><span class="co">#  9 005   Intake  Control   Yes      35     0 Social worker</span></span>
<span><span class="co"># 10 005   3-month Control   Yes      55    39 NA</span></span>
<span><span class="co"># # ℹ 94 more rows</span></span></code></pre></div>
<p>Whereas <code>format = "haven"</code> yields a dataset with
SPSS-style variable labels, value labels, and user missings encoded
using the <code>"haven_labelled_spss"</code> class.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cb_get_data.html">cb_get_data</a></span><span class="op">(</span><span class="va">cb</span>, format <span class="op">=</span> <span class="st">"haven"</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 104 × 7</span></span>
<span><span class="co">#    XPID      XOBS        XRA           B17       SU4a      SU4b      SU1f99v    </span></span>
<span><span class="co">#    &lt;chr+lbl&gt; &lt;dbl+lbl&gt;   &lt;dbl+lbl&gt;     &lt;dbl+lbl&gt; &lt;dbl+lbl&gt; &lt;dbl+lbl&gt; &lt;chr+lbl&gt;</span></span>
<span><span class="co">#  1 001       0 [Intake]  1 [Treatment] 0 [No]    -9 (NA)   -9 (NA)   -9 (NA)    </span></span>
<span><span class="co">#  2 002       0 [Intake]  0 [Control]   0 [No]    10         4        -9 (NA)    </span></span>
<span><span class="co">#  3 003       0 [Intake]  1 [Treatment] 0 [No]    10         1        Peer couns…</span></span>
<span><span class="co">#  4 003       1 [3-month] 1 [Treatment] 0 [No]    39        15        -4 (NA)</span></span>
<span><span class="co">#  5 003       2 [6-month] 1 [Treatment] 0 [No]    -4 (NA)   -4 (NA)   -4 (NA)</span></span>
<span><span class="co">#  6 004       0 [Intake]  0 [Control]   0 [No]    10         2        -9 (NA)    </span></span>
<span><span class="co">#  7 004       1 [3-month] 0 [Control]   0 [No]    55        63        -9 (NA)</span></span>
<span><span class="co">#  8 004       2 [6-month] 0 [Control]   0 [No]    10         1        -9 (NA)</span></span>
<span><span class="co">#  9 005       0 [Intake]  0 [Control]   1 [Yes]   35         0        Social wor…</span></span>
<span><span class="co"># 10 005       1 [3-month] 0 [Control]   1 [Yes]   55        39        -9 (NA)</span></span>
<span><span class="co"># # ℹ 94 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="get-data-summaries">Get data summaries<a class="anchor" aria-label="anchor" href="#get-data-summaries"></a>
</h3>
<p><code><a href="../reference/cb_summarize_numeric.html">cb_summarize_numeric()</a></code>,
<code><a href="../reference/cb_summarize_categorical.html">cb_summarize_categorical()</a></code>, and
<code><a href="../reference/cb_summarize_text.html">cb_summarize_text()</a></code> return summaries for all variables of
their respective types. These are the basis of the summary tabs
generated by <code><a href="../reference/cb_write.html">cb_write()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cb_summarize_numeric.html">cb_summarize_numeric</a></span><span class="op">(</span><span class="va">cb</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 2 × 8</span></span>
<span><span class="co">#   name  label                         valid_n valid_pct  mean    SD median   MAD</span></span>
<span><span class="co">#   &lt;chr&gt; &lt;chr&gt;                           &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co"># 1 SU4a  PPS - P90 days alcohol use         63     0.606 23.4   21.2     20 25.2 </span></span>
<span><span class="co"># 2 SU4b  PPS - P90 days drunk or 5+ d…      58     0.558  8.09  13.6      2  2.97</span></span>
<span><span class="co"># # ℹ 5 more variables: min &lt;dbl&gt;, max &lt;dbl&gt;, range &lt;dbl&gt;, skew &lt;dbl&gt;, kurt &lt;dbl&gt;</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cb_summarize_categorical.html">cb_summarize_categorical</a></span><span class="op">(</span><span class="va">cb</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="co"># # A tibble: 9 × 7</span></span>
<span><span class="co">#   name  label             is_missing value             n pct_of_all pct_of_valid</span></span>
<span><span class="co">#   &lt;chr&gt; &lt;chr&gt;             &lt;lgl&gt;      &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co"># 1 XOBS  Observation Wave  FALSE      [0] Intake       42    0.404         0.404</span></span>
<span><span class="co"># 2 XOBS  Observation Wave  FALSE      [1] 3-month      34    0.327         0.327</span></span>
<span><span class="co"># 3 XOBS  Observation Wave  FALSE      [2] 6-month      28    0.269         0.269</span></span>
<span><span class="co"># 4 XRA   Random assignment FALSE      [0] Control      50    0.481         0.481 </span></span>
<span><span class="co"># 5 XRA   Random assignment FALSE      [1] Treatment    54    0.519         0.519</span></span>
<span><span class="co"># 6 B17   Pregnant          FALSE      [1] Yes           6    0.0577        0.0741</span></span>
<span><span class="co"># 7 B17   Pregnant          FALSE      [0] No           75    0.721         0.926</span></span>
<span><span class="co"># 8 B17   Pregnant          TRUE       [-9] Legitim…    22    0.212        NA</span></span>
<span><span class="co"># 9 B17   Pregnant          TRUE       [-4] Missing      1    0.00962      NA     </span></span>
<span><span class="co"># # ℹ 1 more variable: pct_of_missing &lt;dbl&gt;</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cb_summarize_text.html">cb_summarize_text</a></span><span class="op">(</span><span class="va">cb</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 14 × 7</span></span>
<span><span class="co">#    name    label                      is_missing unique_n value     n pct_of_all</span></span>
<span><span class="co">#    &lt;chr&gt;   &lt;chr&gt;                      &lt;lgl&gt;         &lt;int&gt; &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#  1 XPID    Participant ID             FALSE            42 003       3    0.0288 </span></span>
<span><span class="co">#  2 XPID    Participant ID             FALSE            42 004       3    0.0288</span></span>
<span><span class="co">#  3 XPID    Participant ID             FALSE            42 005       3    0.0288</span></span>
<span><span class="co">#  4 XPID    Participant ID             FALSE            42 006       3    0.0288</span></span>
<span><span class="co">#  5 XPID    Participant ID             FALSE            42 010       3    0.0288</span></span>
<span><span class="co">#  6 XPID    Participant ID             FALSE            42 (37 …    89    0.856</span></span>
<span><span class="co">#  7 SU1f99v QCS - P90 Days Other AOD … FALSE             8 AA        1    0.00962</span></span>
<span><span class="co">#  8 SU1f99v QCS - P90 Days Other AOD … FALSE             8 Alco…     1    0.00962</span></span>
<span><span class="co">#  9 SU1f99v QCS - P90 Days Other AOD … FALSE             8 Case…     1    0.00962</span></span>
<span><span class="co"># 10 SU1f99v QCS - P90 Days Other AOD … FALSE             8 Group     1    0.00962</span></span>
<span><span class="co"># 11 SU1f99v QCS - P90 Days Other AOD … FALSE             8 NA        1    0.00962</span></span>
<span><span class="co"># 12 SU1f99v QCS - P90 Days Other AOD … FALSE             8 (3 o…     3    0.0288 </span></span>
<span><span class="co"># 13 SU1f99v QCS - P90 Days Other AOD … TRUE             NA [-4]…    44    0.423</span></span>
<span><span class="co"># 14 SU1f99v QCS - P90 Days Other AOD … TRUE             NA [-9]…    52    0.5</span></span>
<span><span class="co"># # ℹ 2 more variables: pct_of_valid &lt;dbl&gt;, pct_of_missing &lt;dbl&gt;</span></span></code></pre></div>
<p><code><a href="../reference/cb_summarize_numeric.html">cb_summarize_numeric()</a></code> and
<code><a href="../reference/cb_summarize_categorical.html">cb_summarize_categorical()</a></code> can also return grouped
summaries:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cb_summarize_numeric.html">cb_summarize_numeric</a></span><span class="op">(</span><span class="va">cb</span>, group_by <span class="op">=</span> <span class="va">XOBS</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 6 × 8</span></span>
<span><span class="co">#   XOBS    name  label                      valid_n valid_pct  mean     SD median</span></span>
<span><span class="co">#   &lt;fct&gt;   &lt;chr&gt; &lt;chr&gt;                        &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co"># 1 Intake  SU4a  PPS - P90 days alcohol use      30     0.714 28.8  20.1     26.5</span></span>
<span><span class="co"># 2 3-month SU4a  PPS - P90 days alcohol use      20     0.588 21.4  21.0     12.5</span></span>
<span><span class="co"># 3 6-month SU4a  PPS - P90 days alcohol use      13     0.464 13.9  21.5      6</span></span>
<span><span class="co"># 4 Intake  SU4b  PPS - P90 days drunk or 5…      30     0.714  7.13 10.7      4</span></span>
<span><span class="co"># 5 3-month SU4b  PPS - P90 days drunk or 5…      15     0.441 16.1  20.0      3</span></span>
<span><span class="co"># 6 6-month SU4b  PPS - P90 days drunk or 5…      13     0.464  1     0.707    1</span></span>
<span><span class="co"># # ℹ 6 more variables: MAD &lt;dbl&gt;, min &lt;dbl&gt;, max &lt;dbl&gt;, range &lt;dbl&gt;, skew &lt;dbl&gt;, </span></span>
<span><span class="co"># #   kurt &lt;dbl&gt;</span></span>
<span></span>
<span><span class="fu"><a href="../reference/cb_summarize_categorical.html">cb_summarize_categorical</a></span><span class="op">(</span><span class="va">cb</span>, group_by <span class="op">=</span> <span class="va">XRA</span><span class="op">)</span></span>
<span><span class="co"># # A tibble: 12 × 7</span></span>
<span><span class="co">#    XRA       name  label            value           n pct_of_all pct_of_valid</span></span>
<span><span class="co">#    &lt;fct&gt;     &lt;chr&gt; &lt;chr&gt;            &lt;chr&gt;       &lt;int&gt;      &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#  1 Control   XOBS  Observation Wave [0] Intake     20     0.4          0.4</span></span>
<span><span class="co">#  2 Control   XOBS  Observation Wave [1] 3-month    16     0.32         0.32  </span></span>
<span><span class="co">#  3 Control   XOBS  Observation Wave [2] 6-month    14     0.28         0.28</span></span>
<span><span class="co">#  4 Treatment XOBS  Observation Wave [0] Intake     22     0.407        0.407</span></span>
<span><span class="co">#  5 Treatment XOBS  Observation Wave [1] 3-month    18     0.333        0.333</span></span>
<span><span class="co">#  6 Treatment XOBS  Observation Wave [2] 6-month    14     0.259        0.259</span></span>
<span><span class="co">#  7 Control   B17   Pregnant         [1] Yes         3     0.06         0.0811</span></span>
<span><span class="co">#  8 Control   B17   Pregnant         [0] No         34     0.68         0.919 </span></span>
<span><span class="co">#  9 Control   B17   Pregnant         (Missing)      13     0.26        NA</span></span>
<span><span class="co"># 10 Treatment B17   Pregnant         [1] Yes         3     0.0556       0.0682</span></span>
<span><span class="co"># 11 Treatment B17   Pregnant         [0] No         41     0.759        0.932</span></span>
<span><span class="co"># 12 Treatment B17   Pregnant         (Missing)      10     0.185       NA</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>lighthouse.codebook</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
