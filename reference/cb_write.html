<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write codebook and data summaries to an Excel workbook — cb_write • lighthouse.codebook</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write codebook and data summaries to an Excel workbook — cb_write"><meta name="description" content="cb_write() writes an Excel workbook to disk with tabs including a codebook;
summary statistics for numeric variables; frequencies for categorical variables;
truncated frequencies for text variables; and optional grouped summaries for numeric
and categorical variables.
For data summaries, variables with value labels, factors, and logical variables
are treated as categorical; numeric and integer variables are treated as numeric;
and (unlabeled) character variables are treated as text. Summary tabs will be
omitted if there are no variables of the relevant type."><meta property="og:description" content="cb_write() writes an Excel workbook to disk with tabs including a codebook;
summary statistics for numeric variables; frequencies for categorical variables;
truncated frequencies for text variables; and optional grouped summaries for numeric
and categorical variables.
For data summaries, variables with value labels, factors, and logical variables
are treated as categorical; numeric and integer variables are treated as numeric;
and (unlabeled) character variables are treated as text. Summary tabs will be
omitted if there are no variables of the relevant type."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lighthouse.codebook</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ccsarapas/lighthouse.codebook/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Write codebook and data summaries to an Excel workbook</h1>
      <small class="dont-index">Source: <a href="https://github.com/ccsarapas/lighthouse.codebook/blob/v0.2.1/R/cb_write.r" class="external-link"><code>R/cb_write.r</code></a></small>
      <div class="d-none name"><code>cb_write.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>cb_write()</code> writes an Excel workbook to disk with tabs including a codebook;
summary statistics for numeric variables; frequencies for categorical variables;
truncated frequencies for text variables; and optional grouped summaries for numeric
and categorical variables.</p>
<p>For data summaries, variables with value labels, factors, and logical variables
are treated as categorical; numeric and integer variables are treated as numeric;
and (unlabeled) character variables are treated as text. Summary tabs will be
omitted if there are no variables of the relevant type.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cb_write</span><span class="op">(</span></span>
<span>  <span class="va">cb</span>,</span>
<span>  <span class="va">file</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  incl_date <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  incl_dims <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hyperlinks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  group_by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_rows_numeric <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  detail_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"if_any_user_missing"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span>,</span>
<span>  n_text_vals <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cb">cb<a class="anchor" aria-label="anchor" href="#arg-cb"></a></dt>
<dd><p>An object of class <code>"li_codebook"</code> as produced by <code><a href="cb_create.html">cb_create()</a></code> or
a variant.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>Path to write to.</p></dd>


<dt id="arg-dataset-name">dataset_name<a class="anchor" aria-label="anchor" href="#arg-dataset-name"></a></dt>
<dd><p>Name of the dataset to display in workbook headers.</p></dd>


<dt id="arg-incl-date-incl-dims">incl_date, incl_dims<a class="anchor" aria-label="anchor" href="#arg-incl-date-incl-dims"></a></dt>
<dd><p>Should the date and/or dataset dimensions be included
in the Overview tab header?</p></dd>


<dt id="arg-hyperlinks">hyperlinks<a class="anchor" aria-label="anchor" href="#arg-hyperlinks"></a></dt>
<dd><p>If <code>TRUE</code>, variable names on the Overview sheet will link
to corresponding rows on summary tabs and vice versa.</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>&lt;<code><a href="https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html" class="external-link">tidy-select</a></code>&gt; Column or columns to group
by. If specified, additional numeric and categorical summary tabs will be included
with grouped summaries. Subgroups are shown in columns by default. For the numeric
summary tab, subgroups for some or all grouping variables can instead be shown
in rows if specified in <code>group_rows_numeric</code>.</p></dd>


<dt id="arg-group-rows-numeric">group_rows_numeric<a class="anchor" aria-label="anchor" href="#arg-group-rows-numeric"></a></dt>
<dd><p>&lt;<code><a href="https://dplyr.tidyverse.org/reference/dplyr_tidy_select.html" class="external-link">tidy-select</a></code>&gt; Column or columns
to group by in rows on the grouped numeric summary tab. All columns must also
be specified in <code>group_by</code>.</p></dd>


<dt id="arg-detail-missing">detail_missing<a class="anchor" aria-label="anchor" href="#arg-detail-missing"></a></dt>
<dd><p>Include detailed missing value information on ungrouped
categorical and text summary tabs? (Detailed missing information for grouped
summary tabs is not currently supported.)</p></dd>


<dt id="arg-n-text-vals">n_text_vals<a class="anchor" aria-label="anchor" href="#arg-n-text-vals"></a></dt>
<dd><p>On the text summary tab, how many unique non-missing values
should be included for each variable? If there are more than <code>n_text_vals</code> + 1
unique values, the <code>n_text_vals</code> most common non-missing values will be included.</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>Overwrite existing file?</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns the path to the written Excel file. The Excel workbook itself
will contain an "Overview" tab (see <code><a href="cb_create.html">cb_create()</a></code> and variants for details);
"Summary - Numeric", "Summary - Categorical", and "Summary - Text" tabs if the
dataset includes variables of the relevant type (see <code><a href="cb_summarize_numeric.html">cb_summarize_numeric()</a></code>,
<code><a href="cb_summarize_categorical.html">cb_summarize_categorical()</a></code>, and <code><a href="cb_summarize_text.html">cb_summarize_text()</a></code>); and "Grouped Summary - Numeric"
and "Grouped Summary - Categorical" tabs if <code>group_by</code> is specified.</p>
    </div>
    <div class="section level2">
    <h2 id="alternative-labelling-for-user-missing-values">Alternative labelling for user missing values<a class="anchor" aria-label="anchor" href="#alternative-labelling-for-user-missing-values"></a></h2>



<p>Different terminology for user missing values can be used by setting
<code>options(lighthouse.codebook.nonresponse = TRUE)</code>. If set, the "User Missings"
column on the Overview sheet is instead called "Nonresponse Codes," and "Missing"
values are instead referred to as "Excluded" values on overview and summary tabs.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>lighthouse.codebook</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

